commit f22593b82b5d1668d1997dbccd10a9c31ffea3b3
Author: Dov Grobgeld <dov.grobgeld@gmail.com>
Date:   Fri Mar 25 09:09:49 2022 +0300

    Protected against garbage in the CapRTL encoder

Index: fribidi-0.19.7/charset/fribidi-char-sets-cap-rtl.c
===================================================================
--- fribidi-0.19.7.orig/charset/fribidi-char-sets-cap-rtl.c	2022-03-31 11:03:00.603033644 +0200
+++ fribidi-0.19.7/charset/fribidi-char-sets-cap-rtl.c	2022-03-31 11:03:00.599033645 +0200
@@ -226,7 +226,12 @@
 	    }
 	}
       else
-	us[j++] = caprtl_to_unicode[(int) s[i]];
+      {
+        if ((int)s[i] < 0)
+          us[j++] = '?';
+        else
+          us[j++] = caprtl_to_unicode[(int) s[i]];
+      }
     }
 
   return j;
